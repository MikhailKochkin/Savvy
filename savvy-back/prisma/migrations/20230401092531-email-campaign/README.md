# Migration `20230401092531-email-campaign`

This migration has been generated by MikhailKochkin at 4/1/2023, 1:25:31 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "EmailReminder" ADD COLUMN     "status" INTEGER,
ADD COLUMN     "emailCampaignId" TEXT

CREATE TABLE "EmailCampaign" (
    "id" TEXT NOT NULL,
    "content" TEXT NOT NULL,
    "emails" JSONB,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

ALTER TABLE "EmailReminder" ADD FOREIGN KEY("emailCampaignId")REFERENCES "EmailCampaign"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20230331092648-..20230401092531-email-campaign
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Application {
   id            String     @id @default(cuid())
@@ -914,20 +914,33 @@
   user      User?
 }
 model EmailReminder {
-  id           String      @id @default(cuid())
-  userId       String?
-  user         User?     @relation(fields: [userId], references: [id])
-  coursePageId String?
-  coursePage   CoursePage? @relation(fields: [coursePageId], references: [id])
-  sendAt       DateTime?
-  emailsSent   String[]
-  link         String?
-  createdAt    DateTime     @default(now())
-  updatedAt    DateTime     @updatedAt
+  id              String      @id @default(cuid())
+  userId          String?
+  user            User?     @relation(fields: [userId], references: [id])
+  coursePageId    String?
+  coursePage      CoursePage? @relation(fields: [coursePageId], references: [id])
+  sendAt          DateTime?
+  status          Int?
+  emailsSent      String[]
+  emailCampaignId String?
+  emailCampaign   EmailCampaign? @relation(fields: [emailCampaignId], references: [id])
+  link            String?
+  createdAt       DateTime     @default(now())
+  updatedAt       DateTime     @updatedAt
 }
+
+model EmailCampaign {
+  id              String          @id @default(cuid())
+  content         String
+  emails          Json?
+  emailReminders  EmailReminder[]
+  createdAt       DateTime        @default(now())
+  updatedAt       DateTime        @updatedAt
+}
+
 model Exam {
   id         String       @id
   nodeType   String?
   nodeID     String?
```


