# Migration `20220815175027-add-messages-to-user`

This migration has been generated by MikhailKochkin at 8/15/2022, 9:50:27 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "User" DROP COLUMN "message"

CREATE TABLE "Message" (
    "id" TEXT NOT NULL,
    "text" TEXT,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "userId" TEXT,

    PRIMARY KEY ("id")
)

ALTER TABLE "Message" ADD FOREIGN KEY("userId")REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20220812171145-installments..20220815175027-add-messages-to-user
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Application {
   id            String     @id @default(cuid())
@@ -698,9 +698,9 @@
   description         String?
   resume              String?
   coverLetter         String?
   surname             String?
-  message             String?
+  messages            Message[]
   comment             String?
   work                String?
   image               String?
   favourites          String[]
@@ -762,8 +762,17 @@
   co_coursePages      CoursePage[]         @relation("AuthorsCoursePage")
   new_subjects        CoursePage[]         @relation("UserSubjects")
 }
+model Message {
+  id        String   @id @default(cuid())
+  text      String?  
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  userId    String?
+  user      User?     @relation(fields: [userId], references: [id])
+}
+
 model UserLevel {
   id        String   @id @default(cuid())
   level     Float?   @default(1)
   createdAt DateTime @default(now())
```


