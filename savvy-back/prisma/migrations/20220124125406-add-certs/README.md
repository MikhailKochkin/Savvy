# Migration `20220124125406-add-certs`

This migration has been generated by MikhailKochkin at 1/24/2022, 3:54:06 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Certificate" (
    "id" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "studentId" TEXT NOT NULL,
    "coursePageId" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

ALTER TABLE "Certificate" ADD FOREIGN KEY("coursePageId")REFERENCES "CoursePage"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Certificate" ADD FOREIGN KEY("studentId")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20220118154553-update-promocode..20220124125406-add-certs
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Application {
   id            String     @id @default(cuid())
@@ -189,8 +189,9 @@
   careerTrackUnit   CareerTrackUnit[]
   careerTrack       CareerTrack[]     @relation("CoursePageForCareer")
   posts             Post[]            @relation("PostCoursePages")
   new_students      User[]            @relation("UserSubjects")
+  certificates      Certificate[]
 }
 model CourseVisit {
   id           String     @id @default(cuid())
@@ -206,8 +207,18 @@
   coursePage   CoursePage @relation(fields: [coursePageId], references: [id])
   student      User       @relation(fields: [studentId], references: [id])
 }
+model Certificate {
+  id           String     @id @default(cuid())
+  createdAt    DateTime   @default(now())
+  updatedAt    DateTime   @updatedAt
+  studentId    String
+  coursePageId String
+  coursePage   CoursePage @relation(fields: [coursePageId], references: [id])
+  student      User       @relation(fields: [studentId], references: [id])
+}
+
 model Document {
   id              String           @id @default(cuid())
   title           String
   createdAt       DateTime         @default(now())
@@ -660,8 +671,9 @@
   documentResults     DocumentResult[]
   exams               Exam[]
   examAnswers         ExamAnswer[]
   examResults         ExamResult[]
+  certificates        Certificate[]
   studentFeedback     Feedback[]           @relation("StudentFeedback")
   teacherFeedback     Feedback[]           @relation("TeacherFeedback")
   forums              Forum[]
   lessons             Lesson[]
```


