# Migration `20221208152720-offers`

This migration has been generated by MikhailKochkin at 12/8/2022, 7:27:20 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Offer" (
    "id" TEXT NOT NULL,
    "header" TEXT NOT NULL,
    "text" TEXT NOT NULL,
    "type" TEXT,
    "courseId" TEXT,
    "price" INTEGER,
    "discountPrice" INTEGER,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "userId" TEXT,
    "lessonId" TEXT,

    PRIMARY KEY ("id")
)

ALTER TABLE "Offer" ADD FOREIGN KEY("lessonId")REFERENCES "Lesson"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "Offer" ADD FOREIGN KEY("userId")REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20221129115302-my_teams..20221208152720-offers
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Application {
   id            String     @id @default(cuid())
@@ -407,8 +407,9 @@
   texteditors         TextEditor[]
   textEditorResults   TextEditorResult[]
   teamQuests          TeamQuest[]
   teamQuestResults    TeamQuestResult[]
+  offers              Offer[]
 }
 model LessonResult {
   id           String   @id @default(cuid())
@@ -493,8 +494,24 @@
   lesson     Lesson?  @relation(fields: [lessonId], references: [id])
   user       User?    @relation(fields: [userId], references: [id])
 }
+model Offer {
+  id            String   @id @default(cuid())
+  header        String
+  text          String
+  type          String?
+  courseId      String?
+  price         Int?
+  discountPrice Int?
+  updatedAt     DateTime @updatedAt
+  createdAt     DateTime @default(now())
+  userId        String?
+  lessonId      String?
+  lesson        Lesson?  @relation(fields: [lessonId], references: [id])
+  user          User?    @relation(fields: [userId], references: [id])
+}
+
 model Order {
   id           String     @id @default(cuid())
   price        Int?
   createdAt    DateTime   @default(now())
@@ -847,8 +864,9 @@
   teamQuests          TeamQuest[]
   teamQuestResults    TeamQuestResult[]
   co_coursePages      CoursePage[]         @relation("AuthorsCoursePage")
   new_subjects        CoursePage[]         @relation("UserSubjects")
+  offers              Offer[]
 }
 model Message {
   id        String   @id @default(cuid())
```


